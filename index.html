<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Hello World!</title>
    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />
</head>

<body>
  
  <h1>MP3 Player</h1>
  <button id="select-folder">Select Folder</button>
  <ul id="file-list"></ul>
  <div id="pagination"></div>
  <audio id="audio-player" controls></audio>

  <script>
    const { ipcRenderer } = require('electron');

    let currentPage = 1;
    const itemsPerPage = 13;
    let files = [];

    document.getElementById('select-folder').addEventListener('click', () => {
      ipcRenderer.send('open-folder-dialog');
    });

    ipcRenderer.on('folder-selected', (event, folderPath) => {
      ipcRenderer.send('get-files', folderPath);
    });

    ipcRenderer.on('files-list', (event, fileList) => {
      files = fileList;
      showFiles(1);
    });

    function showFiles(page) {
      const fileList = document.getElementById('file-list');
      fileList.innerHTML = ''; // Clear previous file list

      const startIndex = (page - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const displayedFiles = files.slice(startIndex, endIndex);

      displayedFiles.forEach((file) => {
        const listItem = document.createElement('li');
        listItem.textContent = file.name;
        listItem.addEventListener('click', () => {
          document.getElementById('audio-player').src = file.path;
          document.getElementById('audio-player').play();
        });
        fileList.appendChild(listItem);
      });

      showPagination();
    }

    function showPagination() {
      const pagination = document.getElementById('pagination');
      pagination.innerHTML = ''; // Clear previous pagination

      const totalPages = Math.ceil(files.length / itemsPerPage);

      for (let i = 1; i <= totalPages; i++) {
        const pageNumber = document.createElement('span');
        pageNumber.textContent = i;
        pageNumber.addEventListener('click', () => {
          currentPage = i;
          showFiles(currentPage);
        });
        pagination.appendChild(pageNumber);
      }
    }
  </script>
</body>

</html>